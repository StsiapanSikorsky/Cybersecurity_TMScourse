# Дипломный проект:
## 1. Расследование инцидентов (ответы на вопросы)  

1) У Вас есть логи безопасности для фаервола между DMZ и интернетом. Как вы будете использовать эти логи для обнаружения угроз?  
**Ответ:**  
Логи фаервола содержат информацию о входящем и исходящем трафике, что позволяет выявить подозрительные активности и потенциальные атаки. При помощи данных логов можно произвести следующие действия:    
- регулярный анализ логов на предмет аномальных паттернов (необычные объемы трафика, частые попытки входа или обращения к закрытым портам)    
- поиск и анализ IP-адресов, генерирующих большое количество запросов за короткий промежуток времени (DDoS, Brute force)  
- сравнение логов с БД известных вредоносных IP-адресов и доменов  
- проверка срабатывания правил firewall для выявления блокируемых соединений  
- использование системы обнаружения вторжений (IDS) для автоматического анализа логов и выявления подозрительных действий  
- на основе анализа логов и инцидентов обновление правил firewall для блокировки новых угроз и минимизации уязвимостей в системе  

2) Вы аналитик SOC и у Вас есть предупреждение от системы IDS о SQL-инъекции на Веб-сервер. Что вы будете делать? Как вы будете исследовать технические аспекты?  
**Ответ:**    

3) Наиболее частые компромитирующие сценарии Windows связаны с использованием инструментов снимающих дамп хэшированного пароля. Предложите сценарии обнаружения (чем больше, тем лучше), использования инструментов хэш-дампов. Как обнаружить использование украденных полномочий?
**Ответ:**  

4) Вы работаете в компании и имеете два офиса (Минск и Могилев), вы также имеете логи для VPN, Gateway, FireWall, системы управления физическим контролем доступа. Предложите сценарии для обнаружения возможных угроз.  
**Ответ:**  

5) Если у Вас есть антивирусные логи, какие правила корреляции (сценарии обнаружения) вы можете предложить?
**Ответ:**  





## 3. Автоматизировать процесс проверки url через virustotal  

Для автоматизации процесса проверки URL через virustotal необходимо пройти регистрацию на их сайте, а также воспользоваться встроенным API, который находится в нашем профиле (переменная в  коде: apikey).


### Код скрипта  

```python
#!/usr/bin/env python3
import requests
import json

input_url = str(input("Сканирование, введите URL который хотите просканировать \n"))

#Отправка HTTP POST запроса
api_url = "https://www.virustotal.com/vtapi/v2/url/scan"
params = dict (apikey = "6322a317fe297cf1b310189b2bf1261df2afd557181e8f6ffa66963f75b72bb2", url = input_url)
response = requests.post(api_url, data = params)

#Обработка ответа
if response.status_code == 200:
#преобразование объекта json в словарь python
    result = response.json()
    #print(json.dumps(result, sort_keys = False, indent = 4))
else:
    print("Ошибка", response.status_code)

#Получение id отчета из словаря python
report_id = result.get('scan_id')

#Получение отчета о сканировании по id
print("Отчет о сканированном URL:")
api_url = 'https://www.virustotal.com/vtapi/v2/url/report'
params = dict(apikey='6322a317fe297cf1b310189b2bf1261df2afd557181e8f6ffa66963f75b72bb2', resource = report_id)
response = requests.get(api_url, params = params)
if response.status_code == 200:
  result=response.json()
  #print(json.dumps(result, sort_keys = False, indent = 4))

#Обработка результата
false_count = 0
true_count = 0
for key in result['scans']:
    result_detection = str(result['scans'][key]['detected'])
    if result_detection == 'False':
        false_count += 1
    else:
        true_count += 1
        print('Обнаружено в антивирусе: ',key)


print('Опасность обнаружена в ', true_count,'антивирусах')
print(false_count,' антивирусов показали что URL безопасен')
```

### Результат работы скрипта  
![Virustotal_1](https://github.com/StsiapanSikorsky/Cybersecurity_TMScourse/blob/main/Diplom_project/img/Virustotal_1.png)

Результат работы скрипта, полностью соответствует результатам на проверки URL на сайте  
![Virustotal_2](https://github.com/StsiapanSikorsky/Cybersecurity_TMScourse/blob/main/Diplom_project/img/Virustotal_2.png)  